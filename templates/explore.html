<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>recent history</title>
  <link rel="stylesheet" href="../static/styler.css">
  <link rel="icon" href="../static/prologo.png" type="image/png" sizes="16x16">
  <script>
   function togglepanel() {
    document.getElementById("panel").classList.toggle('active');
  } 
</script>
</head>
<body>
  <nav class="navbar navbar-expand-md navbar-light" style="">
    <a class="navbar-brand" href="#">Navbar</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="nav navbar-nav">
        <li class="nav-item"><a class="nav-link" href="1check.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
        <li class="nav-item"><a class="nav-link" id="recent" href="recent.html">Recents</a></li>
      </ul>
      <ul class="nav navbar-nav ml-auto">
        <li class="nav-item" id="login"><a class="nav-link" href="new12.htm">Login/signup</a></li>
        <li class="nav-item" id="logout"><a class="nav-link" onclick="logout()" href="">Logout</a>
        </li>
      </ul>
    </div>
  </nav>
  <section>
    <div class="container">
      <header>
        <h2>EXPLORE OUR DATABASE...!</h2>
        
      </header>
      <div>
        <p id="p">No Activity</p>
      </div>
      <main id='main'>
      </main>
    </div>
    <img id="baseImg">
  </section>
    <script>
var ip= 'http://localhost:8050';
if(localStorage.getItem('name')==null){
       document.getElementById('recent').style.display="none";
       $("#logout").hide();
   }
   else{
    $("#login").hide();
         $('#logout').show();
         
    }
    function logout(){
             val=confirm('are you sure to log out?');
             if(val){
                localStorage.removeItem('name');
                localStorage.removeItem('email');
            }
            $("#logout").hide();
         $('#login').show();
        }
        table=[];
        tabindex=0;
function getdata(min,max,range) 
{
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() 
  {
    if(this.readyState == 4 && this.status == 200) 
    { 
      recents=this.responseText.split('^');
      for(var i=0;i<recents.length;i++)
      {
        recent=recents[i].split('|');
        
        table.push(recents[i]);
        flower=recent[0];
        var baseString = recent[4].trim();
        text="<div class='abc' style='display:block'><img src='data:image/png;base64,"+baseString+"' alt=''><div class='def'><h3>"+flower+" <span>flower</span></h3><p>By <a href='#'>Ashwin</a> | <a href='#'>Feb 08, 2020</a></p><a href='#' class='btn' id='link' onclick=show("+tabindex+")>Read More</a></div></div>";
        document.getElementById('main').innerHTML=document.getElementById('main').innerHTML+text;
        document.getElementById('p').style.display="none";
        tabindex++;
      }
      if(recents.length==0)
        return
      else
        getdata(max,max+range,range);

    }
    else if(this.readyState==4 && this.status==0)
    {
        alert("connection error!");
    }
  }
  xhttp.open("GET", ip+'/showall?min='+min+'&max='+max, true);
  xhttp.send();
}
range=2;
getdata(0,range,range);
function show(index)
{
  localStorage.setItem('data',table[index])
  window.location.href="rosenew.html"
}
  </script>
  </body>
  </html>
